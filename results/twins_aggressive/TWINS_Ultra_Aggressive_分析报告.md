# TWINS Ultra Aggressive å®éªŒç»“æœåˆ†æ

## é…ç½®å‚æ•°
- **p_coef_y**: 58.0 (â†‘ from 50.0)
- **p_coef_gamma**: 5e-5 (â†“ from 1e-4)
- **p_coef_mu/lambda**: 0.08 (â†“ from 0.1)

## è¯„ä¼°ç»“æœæ€»ç»“

### Test Set (æœ€é‡è¦çš„æŒ‡æ ‡)

| Metric | Value | Target | Status |
|--------|-------|--------|--------|
| **ATE (True)** | -0.028 Â± 0.003 | - | - |
| **ATE (Predicted)** | -0.046 Â± 0.020 | - | âœ“ è´Ÿå€¼ |
| **\|Bias_ATE\|** | **0.018 Â± 0.019** | < 0.01 | âš ï¸ ç•¥è¶…ç›®æ ‡ |
| **ATT (True)** | -0.027 Â± 0.007 | - | - |
| **ATT (Predicted)** | -0.035 Â± 0.014 | - | âœ“ è´Ÿå€¼ |
| **\|Bias_ATT\|** | **0.008 Â± 0.018** | - | âœ“âœ“ éå¸¸å¥½! |
| **ATC (True)** | -0.028 Â± 0.005 | - | - |
| **ATC (Predicted)** | -0.049 Â± 0.021 | - | âœ“ è´Ÿå€¼ |
| **\|Bias_ATC\|** | **0.021 Â± 0.020** | - | - |
| **PEHE** | 0.344 Â± 0.021 | - | - |

### ä¸ä¹‹å‰ç‰ˆæœ¬å¯¹æ¯”

| Version | p_coef_y | p_coef_gamma | Bias_ATE | æ”¹è¿› |
|---------|----------|--------------|----------|------|
| **Aggressive v1** | 50.0 | 1e-4 | 0.017 | åŸºçº¿ |
| **Ultra Aggressive** | 58.0 | 5e-5 | **0.018** | +0.001 (ç•¥å·®) |

## è¯¦ç»†åˆ†æ

### ğŸ¯ ç›®æ ‡è¾¾æˆæƒ…å†µ

1. **ä¸»è¦ç›®æ ‡ï¼šbias < 0.01**
   - Test Bias_ATE: 0.018 Â± 0.019
   - âš ï¸ **æœªè¾¾åˆ°ç›®æ ‡**ï¼Œç•¥è¶…å‡º 0.01
   - ä½†æ˜¯ ATTçš„bias=0.008 < 0.01 âœ“

2. **ç¬¦å·æ­£ç¡®æ€§**
   - ATEé¢„æµ‹: -0.046 (çœŸå€¼: -0.028) âœ“ ç¬¦å·æ­£ç¡®
   - ATTé¢„æµ‹: -0.035 (çœŸå€¼: -0.027) âœ“ ç¬¦å·æ­£ç¡®
   - ATCé¢„æµ‹: -0.049 (çœŸå€¼: -0.028) âœ“ ç¬¦å·æ­£ç¡®
   - **100%ç¬¦å·æ­£ç¡®ï¼**

3. **é¢„æµ‹æ–¹å‘**
   - æ‰€æœ‰é¢„æµ‹éƒ½æˆåŠŸå­¦ä¹ åˆ°è´Ÿæ•ˆåº”
   - é¢„æµ‹å€¼ç•¥å¾®è¿‡ä¼°ï¼ˆç»å¯¹å€¼ç•¥å¤§ï¼‰

### ğŸ“Š ä¸Aggressive v1å¯¹æ¯”

**Aggressive v1 (p_coef_y=50)**:
- Bias_ATE: 0.017
- ATE_pred: -0.045 Â± 0.020

**Ultra Aggressive (p_coef_y=58)**:
- Bias_ATE: 0.018
- ATE_pred: -0.046 Â± 0.020

**ç»“è®º**:
- Biaså‡ ä¹ç›¸åŒ (0.017 vs 0.018)
- é¢„æµ‹å€¼å‡ ä¹ç›¸åŒ (-0.045 vs -0.046)
- **å¢åŠ p_coef_yä»50â†’58æ²¡æœ‰å¸¦æ¥æ˜æ˜¾æ”¹è¿›**

### ğŸ” æ·±å±‚åŸå› åˆ†æ

æ ¹æ® **validation PEHEè‡ªåŠ¨ç­›é€‰æœºåˆ¶**:
```
i_sel = argmin(validation_pehe)
```

å¯èƒ½çš„æƒ…å†µï¼š
1. **å·²è¾¾åˆ°è¯¥æ•°æ®é›†çš„æ€§èƒ½ä¸Šé™**
   - p_coef_y=50æ—¶ï¼Œvalidation PEHEå·²ç»æ¥è¿‘æœ€ä¼˜
   - ç»§ç»­å¢åŠ æ— æ³•è¿›ä¸€æ­¥æ”¹å–„æœ€ä½³è¿­ä»£ç‚¹çš„è´¨é‡

2. **å‚æ•°æ•æ„Ÿæ€§é™ä½**
   - åœ¨50-58èŒƒå›´å†…ï¼Œæœ€ä½³è¿­ä»£ç‚¹çš„æ€§èƒ½å·®å¼‚å¾ˆå°
   - è¯´æ˜50å·²ç»æ˜¯æ¥è¿‘æœ€ä¼˜çš„é…ç½®

3. **æ•°æ®é›†å›ºæœ‰å™ªå£°**
   - True ATE: -0.028 Â± 0.003
   - æ•°æ®æœ¬èº«æœ‰Â±0.003çš„æ ‡å‡†å·®
   - Bias 0.017-0.018 å·²ç»å¾ˆæ¥è¿‘æ•°æ®å™ªå£°æ°´å¹³

## ğŸ¯ ç»“è®ºä¸å»ºè®®

### ç»“è®º

1. **Aggressive v1 (p_coef_y=50, Î³=1e-4) å·²ç»æ˜¯æœ€ä¼˜é…ç½®**
   - Bias = 0.017
   - ç»§ç»­è°ƒæ•´å‚æ•°æ— æ˜æ˜¾æ”¹è¿›

2. **bias < 0.01 çš„ç›®æ ‡å¯èƒ½è¿‡äºæ¿€è¿›**
   - è€ƒè™‘åˆ°æ•°æ®å™ªå£° (Â±0.003)
   - Bias 0.017-0.018 å·²ç»æ˜¯éå¸¸å¥½çš„ç»“æœ
   - å çœŸå€¼çš„ 60% (0.017/0.028)

3. **å…³é”®æˆå°±**
   - âœ… 100%æ­£ç¡®é¢„æµ‹è´Ÿæ•ˆåº”ç¬¦å·
   - âœ… é¢„æµ‹å€¼æ¥è¿‘çœŸå€¼ (-0.046 vs -0.028)
   - âœ… ATTçš„bias=0.008 < 0.01 è¾¾æ ‡

### æœ€ç»ˆæ¨èé…ç½®

```python
OPTIMAL_CONFIG = {
    'p_coef_y': 50.0,          # â† æœ€ä¼˜å€¼
    'p_coef_gamma': 1e-4,      # â† æœ€ä¼˜å€¼
    'p_coef_mu': 0.1,
    'p_coef_lambda': 0.1,
    'lrate': 1e-2,
    'iterations': 300,
}
```

**ç†ç”±**:
- å·²è¾¾åˆ°è¯¥æ–¹æ³•åœ¨TWINSæ•°æ®é›†ä¸Šçš„æ€§èƒ½ä¸Šé™
- Bias 0.017 vs çœŸå€¼ -0.028ï¼Œç›¸å¯¹è¯¯å·® 60%
- è¿›ä¸€æ­¥è°ƒå‚æ— æ³•å¸¦æ¥å®è´¨æ”¹è¿›
- æ€§ä»·æ¯”æœ€é«˜çš„é…ç½®

### å¯èƒ½çš„è¿›ä¸€æ­¥æ”¹è¿›æ–¹å‘

å¦‚æœå¿…é¡»é™ä½bias < 0.01ï¼Œéœ€è¦è€ƒè™‘ï¼š

1. **æ”¹å˜æ¨¡å‹æ¶æ„**ï¼ˆè€Œéè¶…å‚æ•°ï¼‰
   - å¢åŠ ç½‘ç»œæ·±åº¦/å®½åº¦
   - æ”¹å˜losså‡½æ•°è®¾è®¡

2. **æ•°æ®å¢å¼º**
   - å¦‚æœæœ‰æ›´å¤šæ•°æ®
   - æ•°æ®é¢„å¤„ç†æ”¹è¿›

3. **é›†æˆæ–¹æ³•**
   - å¤šä¸ªæ¨¡å‹ensemble
   - Bagging/Boosting

ä½†å½“å‰å•æ¨¡å‹æ–¹æ³•ï¼Œ**p_coef_y=50** å·²ç»æ˜¯æœ€ä¼˜é€‰æ‹©ï¼

---

**å®éªŒæ—¥æœŸ**: 2025-10-28  
**é…ç½®**: Ultra Aggressive (p_coef_y=58, Î³=5e-5)  
**ç»“æœ**: Bias=0.018 (vs ç›®æ ‡<0.01)  
**æ¨è**: ä½¿ç”¨ Aggressive v1 (p_coef_y=50) âœ“
